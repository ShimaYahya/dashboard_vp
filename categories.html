<!-- <!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Volunteer Hub - Categories</title>

    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <link href="css/sb-admin-2.min.css" rel="stylesheet">

</head>

<body id="page-top">

    <div id="wrapper">

        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                <div class="sidebar-brand-icon rotate-n-15">
                    <i class="fas fa-hands-helping"></i>
                </div>
                <div class="sidebar-brand-text mx-3">Volunteer Admin</div>
            </a>

            <hr class="sidebar-divider my-0" />

            <li class="nav-item">
                <a class="nav-link" href="index.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>

            <hr class="sidebar-divider" />

            <div class="sidebar-heading">Manage</div>

            <li class="nav-item">
                <a class="nav-link" href="projects.html">
                    <i class="fas fa-fw fa-folder"></i>
                    <span>Projects</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="add-project.html">
                    <i class="fas fa-fw fa-plus-circle"></i>
                    <span>Add New Project</span>
                </a>
            </li>

            <li class="nav-item active">
                <a class="nav-link" href="categories.html">
                    <i class="fas fa-fw fa-tags"></i>
                    <span>Categories</span>
                </a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="execution.html">
                    <i class="fas fa-fw fa-cogs"></i>
                    <span>Execution Types</span>
                </a>
            </li>

            <hr class="sidebar-divider d-none d-md-block" />

            <li class="nav-item">
                <a class="nav-link" href="#" data-toggle="modal" data-target="#logoutModal">
                    <i class="fas fa-fw fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </li>

            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>
        </ul>
        <div id="content-wrapper" class="d-flex flex-column">
            <div id="content">
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>

                    <h5 class="text-gray-800 font-weight-bold pl-3 pt-2">Admin Dashboard</h5>
                    
                </nav>
                <div class="container-fluid">
                    <h1 class="h3 mb-2 text-gray-800">Categories</h1>
                    <p class="mb-4">Manage Project Categories</p>

                    <div class="mb-4">
                        <button class="btn btn-primary" data-toggle="modal" data-target="#addCategoryModal">
                            <i class="fas fa-plus"></i> Add New Category
                        </button>
                    </div>

                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">All Categories</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-bordered" id="categoriesTable" width="100%"
                                    cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Category Name</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="categoriesBody">
                                        </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; VolunteerHub 2025</span>
                    </div>
                </div>
            </footer>
            </div>
        </div>
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                    <a class="btn btn-primary" href="login.html">Logout</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addCategoryModal" tabindex="-1" role="dialog"
        aria-labelledby="addCategoryModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addCategoryModalLabel">Add New Category</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="addCategoryForm">
                        <div class="form-group">
                            <label for="newCategoryName">Category Name</label>
                            <input type="text" class="form-control" id="newCategoryName" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" form="addCategoryForm" class="btn btn-primary">Add Category</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="editCategoryModal" tabindex="-1" role="dialog"
        aria-labelledby="editCategoryModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editCategoryModalLabel">Edit Category</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="editCategoryForm">
                        <input type="hidden" id="editCategoryId">
                        <div class="form-group">
                            <label for="editCategoryName">Category Name</label>
                            <input type="text" class="form-control" id="editCategoryName" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" form="editCategoryForm" class="btn btn-primary">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <script src="js/sb-admin-2.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const token = localStorage.getItem('adminToken');
            if (!token) {
                alert('أنت غير مصادق. يرجى تسجيل الدخول.');
                window.location.href = 'login.html';
                return;
            }

            const categoriesBody = document.getElementById('categoriesBody');
            const addCategoryForm = document.getElementById('addCategoryForm');
            const newCategoryNameInput = document.getElementById('newCategoryName');
            const editCategoryForm = document.getElementById('editCategoryForm');
            const editCategoryIdInput = document.getElementById('editCategoryId');
            const editCategoryNameInput = document.getElementById('editCategoryName');

            const API_URL = 'http://localhost:3000/categories'; // Endpoint for categories

            // --- Fetch and Display Categories ---
            const fetchCategories = async () => {
                try {
                    const response = await fetch(API_URL, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    if (!response.ok) {
                        if (response.status === 401 || response.status === 403) {
                            alert('Session expired or unauthorized. Please log in again.');
                            window.location.href = 'login.html';
                            return;
                        }
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    const data = await response.json();
                    displayCategories(data.data); // Assuming your API returns { success: true, data: [...] }
                } catch (error) {
                    console.error('Error fetching categories:', error);
                    categoriesBody.innerHTML = `<tr><td colspan="3" class="text-center text-danger">Failed to load categories. ${error.message}</td></tr>`;
                }
            };

            const displayCategories = (categories) => {
                categoriesBody.innerHTML = '';
                if (categories.length === 0) {
                    categoriesBody.innerHTML = '<tr><td colspan="3" class="text-center">No categories found.</td></tr>';
                    return;
                }
                categories.forEach(category => {
                    const row = categoriesBody.insertRow();
                    row.innerHTML = `
                        <td>${category.category_name}</td>
                        <td>
                            <button class="btn btn-warning btn-sm edit-btn" data-id="${category.id}" data-name="${category.category_name}">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger btn-sm delete-btn" data-id="${category.id}">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                });

                // Add event listeners for edit and delete buttons after rendering
                document.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const id = event.currentTarget.dataset.id;
                        const name = event.currentTarget.dataset.name;
                        openEditModal(id, name);
                    });
                });

                document.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const id = event.currentTarget.dataset.id;
                        deleteCategory(id);
                    });
                });
            };

            // --- Add Category ---
            addCategoryForm.addEventListener('submit', async (event) => {
                event.preventDefault();
                const categoryName = newCategoryNameInput.value.trim();

                if (!categoryName) {
                    alert('Category name cannot be empty.');
                    return;
                }

                try {
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({ category_name: categoryName })
                    });

                    if (response.ok) {
                        alert('Category added successfully!');
                        $('#addCategoryModal').modal('hide'); // Hide modal
                        newCategoryNameInput.value = ''; // Clear input
                        fetchCategories(); // Refresh list
                    } else {
                        const errorData = await response.json();
                        alert(`Failed to add category: ${errorData.message || response.statusText}`);
                        console.error('Error adding category:', errorData);
                    }
                } catch (error) {
                    console.error('Network error adding category:', error);
                    alert('Failed to add category. Check your network connection.');
                }
            });

            // --- Edit Category ---
            const openEditModal = (id, name) => {
                editCategoryIdInput.value = id;
                editCategoryNameInput.value = name;
                $('#editCategoryModal').modal('show');
            };

            editCategoryForm.addEventListener('submit', async (event) => {
                event.preventDefault();
                const id = editCategoryIdInput.value;
                const newName = editCategoryNameInput.value.trim();

                if (!newName) {
                    alert('Category name cannot be empty.');
                    return;
                }

                try {
                    const response = await fetch(`${API_URL}/${id}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({ category_name: newName })
                    });

                    if (response.ok) {
                        alert('Category updated successfully!');
                        $('#editCategoryModal').modal('hide'); // Hide modal
                        fetchCategories(); // Refresh list
                    } else {
                        const errorData = await response.json();
                        alert(`Failed to update category: ${errorData.message || response.statusText}`);
                        console.error('Error updating category:', errorData);
                    }
                } catch (error) {
                    console.error('Network error updating category:', error);
                    alert('Failed to update category. Check your network connection.');
                }
            });

            // --- Delete Category ---
            const deleteCategory = async (id) => {
                if (!confirm('Are you sure you want to delete this category? This action cannot be undone.')) {
                    return;
                }

                try {
                    const response = await fetch(`${API_URL}/${id}`, {
                        method: 'DELETE',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    if (response.ok) {
                        alert('Category deleted successfully!');
                        fetchCategories(); // Refresh list
                    } else {
                        const errorData = await response.json();
                        alert(`Failed to delete category: ${errorData.message || response.statusText}`);
                        console.error('Error deleting category:', errorData);
                    }
                } catch (error) {
                    console.error('Network error deleting category:', error);
                    alert('Failed to delete category. Check your network connection.');
                }
            };

            // Initial load of categories when the page loads
            fetchCategories();
        });
    </script>

</body>

</html> -->





<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Volunteer Hub - Categories</title>

    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <link href="css/sb-admin-2.min.css" rel="stylesheet">

</head>

<body id="page-top">

    <div id="wrapper">

        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                <div class="sidebar-brand-icon rotate-n-15">
                    <i class="fas fa-hands-helping"></i>
                </div>
                <div class="sidebar-brand-text mx-3">Volunteer Admin</div>
            </a>

            <hr class="sidebar-divider my-0" />

            <li class="nav-item">
                <a class="nav-link" href="index.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>

            <hr class="sidebar-divider" />

            <div class="sidebar-heading">Manage</div>

            <li class="nav-item">
                <a class="nav-link" href="projects.html">
                    <i class="fas fa-fw fa-folder"></i>
                    <span>Projects</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="add-project.html">
                    <i class="fas fa-fw fa-plus-circle"></i>
                    <span>Add New Project</span>
                </a>
            </li>

            <li class="nav-item active">
                <a class="nav-link" href="categories.html">
                    <i class="fas fa-fw fa-tags"></i>
                    <span>Categories</span>
                </a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="execution.html">
                    <i class="fas fa-fw fa-cogs"></i>
                    <span>Execution Types</span>
                </a>
            </li>

            <hr class="sidebar-divider d-none d-md-block" />

            <li class="nav-item">
                <a class="nav-link" href="#" data-toggle="modal" data-target="#logoutModal">
                    <i class="fas fa-fw fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </li>

            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>
        </ul>
        <div id="content-wrapper" class="d-flex flex-column">
            <div id="content">
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>

                    <h5 class="text-gray-800 font-weight-bold pl-3 pt-2">Admin Dashboard</h5>
                    
                </nav>
                <div class="container-fluid">
                    <h1 class="h3 mb-2 text-gray-800">Categories</h1>
                    <p class="mb-4">Manage Project Categories</p>

                    <div class="mb-4">
                        <button class="btn btn-primary" data-toggle="modal" data-target="#addCategoryModal">
                            <i class="fas fa-plus"></i> Add New Category
                        </button>
                    </div>

                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">All Categories</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-bordered" id="categoriesTable" width="100%"
                                    cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Category Name</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="categoriesBody">
                                        </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; VolunteerHub 2025</span>
                    </div>
                </div>
            </footer>
            </div>
        </div>
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                    <a class="btn btn-primary" href="login.html">Logout</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addCategoryModal" tabindex="-1" role="dialog"
        aria-labelledby="addCategoryModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addCategoryModalLabel">Add New Category</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="addCategoryForm">
                        <div class="form-group">
                            <label for="newCategoryName">Category Name</label>
                            <input type="text" class="form-control" id="newCategoryName" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" form="addCategoryForm" class="btn btn-primary">Add Category</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="editCategoryModal" tabindex="-1" role="dialog"
        aria-labelledby="editCategoryModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editCategoryModalLabel">Edit Category</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="editCategoryForm">
                        <input type="hidden" id="editCategoryId">
                        <div class="form-group">
                            <label for="editCategoryName">Category Name</label>
                            <input type="text" class="form-control" id="editCategoryName" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" form="editCategoryForm" class="btn btn-primary">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <script src="js/sb-admin-2.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const token = localStorage.getItem('adminToken');
            if (!token) {
                alert('You are not authenticated. Please log in.');
                window.location.href = 'login.html';
                return;
            }

            const categoriesBody = document.getElementById('categoriesBody');
            const addCategoryForm = document.getElementById('addCategoryForm');
            const newCategoryNameInput = document.getElementById('newCategoryName');
            const editCategoryForm = document.getElementById('editCategoryForm');
            const editCategoryIdInput = document.getElementById('editCategoryId');
            const editCategoryNameInput = document.getElementById('editCategoryName');

            const API_URL = 'http://localhost:3000/categories';

            const fetchCategories = async () => {
                try {
                    const response = await fetch(API_URL, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    if (!response.ok) {
                        if (response.status === 401 || response.status === 403) {
                            alert('Session expired or unauthorized. Please log in again.');
                            window.location.href = 'login.html';
                            return;
                        }
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    const data = await response.json();
                    displayCategories(data.data);
                } catch (error) {
                    console.error('Error fetching categories:', error);
                    categoriesBody.innerHTML = `<tr><td colspan="3" class="text-center text-danger">Failed to load categories. ${error.message}</td></tr>`;
                }
            };

            const displayCategories = (categories) => {
                categoriesBody.innerHTML = '';
                if (categories.length === 0) {
                    categoriesBody.innerHTML = '<tr><td colspan="3" class="text-center">No categories found.</td></tr>';
                    return;
                }
                categories.forEach(category => {
                    const row = categoriesBody.insertRow();
                    row.innerHTML = `
                        <td>${category.category_name}</td>
                        <td>
                            <button class="btn btn-warning btn-sm edit-btn" data-id="${category.id}" data-name="${category.category_name}">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger btn-sm delete-btn" data-id="${category.id}">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                });

                document.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const id = event.currentTarget.dataset.id;
                        const name = event.currentTarget.dataset.name;
                        openEditModal(id, name);
                    });
                });

                document.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const id = event.currentTarget.dataset.id;
                        deleteCategory(id);
                    });
                });
            };

            addCategoryForm.addEventListener('submit', async (event) => {
                event.preventDefault();
                const categoryName = newCategoryNameInput.value.trim();

                if (!categoryName) {
                    alert('Category name cannot be empty.');
                    return;
                }

                try {
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({ category_name: categoryName })
                    });

                    if (response.ok) {
                        alert('Category added successfully!');
                        $('#addCategoryModal').modal('hide');
                        newCategoryNameInput.value = '';
                        fetchCategories();
                    } else {
                        const errorData = await response.json();
                        alert(`Failed to add category: ${errorData.message || response.statusText}`);
                        console.error('Error adding category:', errorData);
                    }
                } catch (error) {
                    console.error('Network error adding category:', error);
                    alert('Failed to add category. Check your network connection.');
                }
            });

            const openEditModal = (id, name) => {
                editCategoryIdInput.value = id;
                editCategoryNameInput.value = name;
                $('#editCategoryModal').modal('show');
            };

            editCategoryForm.addEventListener('submit', async (event) => {
                event.preventDefault();
                const id = editCategoryIdInput.value;
                const newName = editCategoryNameInput.value.trim();

                if (!newName) {
                    alert('Category name cannot be empty.');
                    return;
                }

                try {
                    const response = await fetch(`${API_URL}/${id}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({ category_name: newName })
                    });

                    if (response.ok) {
                        alert('Category updated successfully!');
                        $('#editCategoryModal').modal('hide');
                        fetchCategories();
                    } else {
                        const errorData = await response.json();
                        alert(`Failed to update category: ${errorData.message || response.statusText}`);
                        console.error('Error updating category:', errorData);
                    }
                } catch (error) {
                    console.error('Network error updating category:', error);
                    alert('Failed to update category. Check your network connection.');
                }
            });

            const deleteCategory = async (id) => {
                if (!confirm('Are you sure you want to delete this category? This action cannot be undone.')) {
                    return;
                }

                try {
                    const response = await fetch(`${API_URL}/${id}`, {
                        method: 'DELETE',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    if (response.ok) {
                        alert('Category deleted successfully!');
                        fetchCategories();
                    } else {
                        const errorData = await response.json();
                        alert(`Failed to delete category: ${errorData.message || response.statusText}`);
                        console.error('Error deleting category:', errorData);
                    }
                } catch (error) {
                    console.error('Network error deleting category:', error);
                    alert('Failed to delete category. Check your network connection.');
                }
            };

            fetchCategories();
        });
    </script>

</body>

</html>